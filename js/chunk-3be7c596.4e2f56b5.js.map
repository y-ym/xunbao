{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///./src/assets/js/utils.js","webpack:///./src/views/SetPword.vue?59df","webpack:///src/views/SetPword.vue","webpack:///./src/views/SetPword.vue?b97d","webpack:///./src/views/SetPword.vue"],"names":["_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","Utils","o","reg","test","value","Toast","message","errorMsg","duration","forbidClick","utils","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","back","isType","toggleType","model","pword","callback","$$v","$set","expression","scopedSlots","_u","fn","getcode","_v","proxy","ackModify","staticRenderFns","name","data","infoData","codekey","newpass","ackPass","code","created","axios","baseUrl","console","log","getInfo","methods","$router","tokenString","push","$toast","loading","method","url","headers","err","phone","res","ackpass","account","captcha","password","component"],"mappings":"kHAAe,SAASA,EAAgBC,EAAUC,GAChD,KAAMD,aAAoBC,GACxB,MAAM,IAAIC,UAAU,qCCFxB,SAASC,EAAkBC,EAAQC,GACjC,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CACrC,IAAIE,EAAaH,EAAMC,GACvBE,EAAWC,WAAaD,EAAWC,aAAc,EACjDD,EAAWE,cAAe,EACtB,UAAWF,IAAYA,EAAWG,UAAW,GACjDC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAInC,SAASO,EAAad,EAAae,EAAYC,GAG5D,OAFID,GAAYb,EAAkBF,EAAYiB,UAAWF,GACrDC,GAAad,EAAkBF,EAAagB,GACzChB,E,kDCXHkB,E,8EAGMC,GAER,IAAK,IAAIN,KAAOM,EACd,IAAKA,EAAEN,GAAKO,IAAIC,KAAKF,EAAEN,GAAKS,OAO1B,OALAC,eAAM,CACJC,QAASL,EAAEN,GAAKY,SAChBC,SAAU,IACVC,aAAa,KAER,EAKX,OAAO,M,KAKEC,EAAQ,IAAIV,G,2CCzBzB,IAAIW,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQ,OAAO,aAAa,IAAIC,GAAG,CAAC,aAAaR,EAAIS,SAAS,GAAGL,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,YAAY,CAACG,MAAM,CAAC,KAAOP,EAAIU,OAAS,OAAS,WAAW,MAAQ,MAAM,YAAc,SAAS,aAAaV,EAAIU,OAAS,QAAU,cAAcF,GAAG,CAAC,mBAAmBR,EAAIW,YAAYC,MAAM,CAACpB,MAAOQ,EAAIa,MAAa,QAAEC,SAAS,SAAUC,GAAMf,EAAIgB,KAAKhB,EAAIa,MAAO,UAAWE,IAAME,WAAW,mBAAmBb,EAAG,YAAY,CAACG,MAAM,CAAC,KAAOP,EAAIU,OAAS,OAAS,WAAW,MAAQ,OAAO,YAAc,SAAS,aAAaV,EAAIU,OAAS,QAAU,cAAcF,GAAG,CAAC,mBAAmBR,EAAIW,YAAYC,MAAM,CAACpB,MAAOQ,EAAIa,MAAa,QAAEC,SAAS,SAAUC,GAAMf,EAAIgB,KAAKhB,EAAIa,MAAO,UAAWE,IAAME,WAAW,mBAAmBb,EAAG,YAAY,CAACG,MAAM,CAAC,OAAS,GAAG,UAAY,GAAG,MAAQ,MAAM,YAAc,YAAYW,YAAYlB,EAAImB,GAAG,CAAC,CAACpC,IAAI,SAASqC,GAAG,WAAW,MAAO,CAAChB,EAAG,aAAa,CAACG,MAAM,CAAC,KAAO,QAAQ,MAAQ,GAAG,MAAQ,oDAAoDC,GAAG,CAAC,MAAQR,EAAIqB,UAAU,CAACrB,EAAIsB,GAAG,aAAaC,OAAM,KAAQX,MAAM,CAACpB,MAAOQ,EAAIa,MAAU,KAAEC,SAAS,SAAUC,GAAMf,EAAIgB,KAAKhB,EAAIa,MAAO,OAAQE,IAAME,WAAW,gBAAgBb,EAAG,IAAI,CAACE,YAAY,SAASE,GAAG,CAAC,MAAQR,EAAIwB,YAAY,CAACxB,EAAIsB,GAAG,WAAW,MAC/4CG,EAAkB,G,yBC2BtB,GACEC,KAAF,WACEC,KAFF,WAGI,MAAO,CAELC,SAAN,GAGMlB,QAAN,EAGMmB,QAAN,GAGMhB,MAAN,CACQiB,QAAR,GACQC,QAAR,GACQC,KAAR,MAKEC,QAtBF,WAsBA,WAEIhC,KAAKiC,MAAMjC,KAAKkC,QAApB,kCACM,EAAN,wBACMC,QAAQC,IAAI,EAAlB,YAGIpC,KAAKqC,WAEPC,QAAF,CAEI9B,KAFJ,WAGMR,KAAKuC,QAAQ/B,QAIfE,WAPJ,WAQMV,KAAKS,QAAU,KAArB,QAII4B,QAZJ,WAYA,WAEA,mCAGM,IAAKG,EAEH,OADAL,QAAQC,IAAI,eACLpC,KAAKuC,QAAQE,KAAK,CAAjC,eAGMzC,KAAK0C,OAAOC,QAAQ,CAClBlD,QAAS,SACTG,aAAa,EACbD,SAAU,IAGZK,KAAKiC,MAAM,CACTW,OAAR,MACQC,IAAR,yBACQC,QAAS,CACP,iBAAkB,UAAYN,KAExC,kBAEQ,EAAR,eAEA,mBAEU,EAAV,sBAGU,EAAV,QACY,QAAZ,WACY,aAAZ,EACY,SAAZ,MAEU,EAAV,2BAEA,mBACQ,EAAR,eACQL,QAAQC,IAAI,WAAYW,OAK5B3B,QAzDJ,WAyDA,WAEMpB,KAAKiC,MAAM,CACTW,OAAQ,OACRC,IAAK7C,KAAKkC,QAAlB,mBACQR,KAAR,CACUK,KAAM,GACNjD,IAAKkB,KAAK4B,QACVoB,MAAOhD,KAAK2B,SAASqB,SAE/B,kBACQb,QAAQC,IAAIa,MACpB,mBACQ,EAAR,eACQd,QAAQC,IAAI,WAAYW,OAM5BxB,UA7EJ,WA6EA,WAEM,GAAIvB,KAAKY,MAAMiB,SAAW7B,KAAKY,MAAMsC,QAArC,CAIA,IAAN,GACQrB,QAAS,CACPtC,MAAOS,KAAKY,MAAMiB,QAClBxC,IAAK,qBACLK,SAAU,mBAGZwD,QAAS,CACP3D,MAAOS,KAAKY,MAAMsC,QAClB7D,IAAK,qBACLK,SAAU,oBAMd,GAAKG,EAAX,kBAAM,CAKA,IAAN,mCAGM,IAAK2C,EAEH,OADAL,QAAQC,IAAI,eACLpC,KAAKuC,QAAQE,KAAK,CAAjC,eAGMzC,KAAK0C,OAAOC,QAAQ,CAClBlD,QAAS,SACTG,aAAa,EACbD,SAAU,IAIZK,KAAKiC,MAAM,CACTW,OAAR,OACQC,IAAR,+BACQnB,KAAR,CACUyB,QAASnD,KAAK2B,SAASqB,MACvBI,QAASpD,KAAKY,MAAMmB,KACpBA,KAAM,GACNsB,SAAUrD,KAAKY,MAAMiB,SAEvBiB,QAAS,CACP,iBAAkB,UAAYN,KAExC,kBAEQ,EAAR,eAEA,mBAEU,EAAV,QACY,QAAZ,WACY,aAAZ,EACY,SAAZ,OAIU,EAAV,QACY,QAAZ,WACY,aAAZ,EACY,SAAZ,MAEU,EAAV,2BAEA,mBACQ,EAAR,eACQL,QAAQC,IAAI,WAAYW,WCpNkT,I,YCO9UO,EAAY,eACd,EACAxD,EACA0B,GACA,EACA,KACA,KACA,MAIa,aAAA8B,E","file":"js/chunk-3be7c596.4e2f56b5.js","sourcesContent":["export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import { Toast } from 'vant';\r\n\r\nclass Utils {\r\n\r\n  //验证表单\r\n  validForm(o) {\r\n    //验证表单的数据, object\r\n    for (let key in o) {\r\n      if (!o[key].reg.test(o[key].value)) {\r\n        //提示\r\n        Toast({\r\n          message: o[key].errorMsg,\r\n          duration: 3000,\r\n          forbidClick: true\r\n        });\r\n        return false;\r\n      }\r\n    }\r\n\r\n    //表单验证通过\r\n    return true;\r\n  }\r\n\r\n}\r\n\r\nexport const utils = new Utils();","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"SetPword\"},[_c('div',{staticClass:\"navtop\"},[_c('van-nav-bar',{attrs:{\"title\":\"修改密码\",\"left-arrow\":\"\"},on:{\"click-left\":_vm.back}})],1),_c('div',{staticClass:\"register\"},[_c('van-field',{attrs:{\"type\":_vm.isType ? 'text' : 'password',\"label\":\"新密码\",\"placeholder\":\"请确认新密码\",\"right-icon\":_vm.isType ? 'eye-o' : 'closed-eye'},on:{\"click-right-icon\":_vm.toggleType},model:{value:(_vm.pword.newpass),callback:function ($$v) {_vm.$set(_vm.pword, \"newpass\", $$v)},expression:\"pword.newpass\"}}),_c('van-field',{attrs:{\"type\":_vm.isType ? 'text' : 'password',\"label\":\"确认密码\",\"placeholder\":\"请确认新密码\",\"right-icon\":_vm.isType ? 'eye-o' : 'closed-eye'},on:{\"click-right-icon\":_vm.toggleType},model:{value:(_vm.pword.ackpass),callback:function ($$v) {_vm.$set(_vm.pword, \"ackpass\", $$v)},expression:\"pword.ackpass\"}}),_c('van-field',{attrs:{\"center\":\"\",\"clearable\":\"\",\"label\":\"验证码\",\"placeholder\":\"请输入短信验证码\"},scopedSlots:_vm._u([{key:\"button\",fn:function(){return [_c('van-button',{attrs:{\"size\":\"small\",\"round\":\"\",\"color\":\"linear-gradient(to right,#ff9000 0,#ff5000 100%)\"},on:{\"click\":_vm.getcode}},[_vm._v(\"发送验证码\")])]},proxy:true}]),model:{value:(_vm.pword.code),callback:function ($$v) {_vm.$set(_vm.pword, \"code\", $$v)},expression:\"pword.code\"}}),_c('p',{staticClass:\"buttom\",on:{\"click\":_vm.ackModify}},[_vm._v(\"确认修改\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"SetPword\">\r\n    <div class=\"navtop\">\r\n      <van-nav-bar title=\"修改密码\" left-arrow @click-left=\"back\" />\r\n    </div>\r\n\r\n    <div class=\"register\">\r\n      <!-- 新密码 -->\r\n      <van-field v-model=\"pword.newpass\" :type=\"isType ? 'text' : 'password'\" label=\"新密码\" placeholder=\"请确认新密码\" :right-icon=\"isType ? 'eye-o' : 'closed-eye'\" @click-right-icon=\"toggleType\"/>\r\n      <!-- 确认密码 -->\r\n      <van-field v-model=\"pword.ackpass\" :type=\"isType ? 'text' : 'password'\" label=\"确认密码\" placeholder=\"请确认新密码\" :right-icon=\"isType ? 'eye-o' : 'closed-eye'\" @click-right-icon=\"toggleType\"/>\r\n      <!-- 验证码 -->\r\n      <van-field v-model=\"pword.code\" center clearable label=\"验证码\" placeholder=\"请输入短信验证码\">\r\n        <template #button>\r\n          <van-button size=\"small\" round color=\"linear-gradient(to right,#ff9000 0,#ff5000 100%)\" @click=\"getcode\">发送验证码</van-button>\r\n        </template>\r\n      </van-field>\r\n\r\n      <p class=\"buttom\" @click=\"ackModify\">确认修改</p>\r\n\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport \"../assets/style/setpword.less\"\r\nimport {utils} from '../assets/js/utils';\r\nexport default {\r\n  name:\"SetPword\",\r\n  data(){\r\n    return {\r\n      //用户信息\r\n      infoData:{},\r\n\r\n      //密码是否可见\r\n      isType:false,\r\n\r\n      //验证码需要的key\r\n      codekey:'',\r\n\r\n      // 修改的密码\r\n      pword:{\r\n        newpass:\"\",\r\n        ackPass:\"\",\r\n        code:\"\"\r\n      }\r\n\r\n    }\r\n  },\r\n  created(){\r\n    // 获取验证码需要的key\r\n    this.axios(this.baseUrl+\"/verify_code\").then(data=>{\r\n      this.codekey = data.data.data.key\r\n      console.log(this.codekey);\r\n    })\r\n\r\n    this.getInfo()\r\n  },\r\n  methods:{\r\n    // 返回上一级\r\n    back(){\r\n      this.$router.back()\r\n    },\r\n\r\n    // 切换密码框类型\r\n    toggleType(){\r\n      this.isType = ! this.isType\r\n    },\r\n\r\n    // 获取用户信息\r\n    getInfo(){\r\n      //获取token\r\n      let tokenString = this.$cookies.get(\"tokenString\");\r\n\r\n      //判断token存不存在\r\n      if (!tokenString) {\r\n        console.log(\"浏览器token不存在\");\r\n        return this.$router.push({ name: \"Login\" });\r\n      }\r\n\r\n      this.$toast.loading({\r\n        message: \"加载中...\",\r\n        forbidClick: true,\r\n        duration: 0,\r\n      });\r\n\r\n      this.axios({\r\n        method:\"GET\",\r\n        url:this.baseUrl+\"/userinfo\",\r\n        headers: {\r\n          \"Authori-zation\": \"Bearer \" + tokenString,\r\n        },\r\n      }).then((res) => {\r\n          // console.log(\"res getAddressListData ==> \", res);\r\n          this.$toast.clear();\r\n          \r\n          if (res.data.status == 200) {\r\n\r\n            this.infoData = res.data.data\r\n\r\n          }else {\r\n            this.$toast({\r\n              message: res.data.msg,\r\n              forbidClick: true,\r\n              duration: 3000,\r\n            });\r\n            this.$router.push(\"/login\")\r\n          }\r\n      }).catch((err) => {\r\n        this.$toast.clear();\r\n        console.log(\"err ==> \", err);\r\n      });\r\n    },\r\n\r\n    //获取验证码\r\n    getcode(){\r\n\r\n      this.axios({\r\n        method: 'POST',\r\n        url: this.baseUrl+'/register/verify',\r\n        data:{\r\n          code: \"\",\r\n          key: this.codekey,\r\n          phone: this.infoData.phone,\r\n        }\r\n      }).then((res)=>{\r\n        console.log(res);\r\n      }).catch(err => {\r\n        this.$toast.clear();\r\n        console.log('err ==> ', err);\r\n      })\r\n\r\n    },\r\n\r\n    // 确认修改密码\r\n    ackModify(){\r\n      // 两个密码必须一样，否则不再执行下一步\r\n      if (this.pword.newpass != this.pword.ackpass) {\r\n        return\r\n      }\r\n\r\n      let reg = {\r\n        newpass: {\r\n          value: this.pword.newpass,\r\n          reg: /^[A-Za-z]\\w{5,15}$/,\r\n          errorMsg: '密码只支持字母数字且以字母开头'\r\n        },\r\n\r\n        ackpass: {\r\n          value: this.pword.ackpass,\r\n          reg: /^[A-Za-z]\\w{5,15}$/,\r\n          errorMsg: '密码只支持字母数字且以字母开头'\r\n        },\r\n      };\r\n\r\n      //验证表单\r\n      //表单验证不通过, 拦截注册请求\r\n      if (!utils.validForm(reg)) {\r\n        return;\r\n      }\r\n\r\n       //获取token\r\n      let tokenString = this.$cookies.get(\"tokenString\");\r\n\r\n      //判断token存不存在\r\n      if (!tokenString) {\r\n        console.log(\"浏览器token不存在\");\r\n        return this.$router.push({ name: \"Login\" });\r\n      }\r\n\r\n      this.$toast.loading({\r\n        message: \"加载中...\",\r\n        forbidClick: true,\r\n        duration: 0,\r\n      });\r\n\r\n      // 发起修改请求\r\n      this.axios({\r\n        method:\"POST\",\r\n        url:this.baseUrl+\"/register/reset\",\r\n        data:{\r\n          account: this.infoData.phone,\r\n          captcha: this.pword.code,\r\n          code: \"\",\r\n          password: this.pword.newpass\r\n        },\r\n        headers: {\r\n          \"Authori-zation\": \"Bearer \" + tokenString,\r\n        },\r\n      }).then((res) => {\r\n          // console.log(\"res getAddressListData ==> \", res);\r\n          this.$toast.clear();\r\n          \r\n          if (res.data.status == 200) {\r\n\r\n            this.$toast({\r\n              message: res.data.msg,\r\n              forbidClick: true,\r\n              duration: 2000,\r\n            });\r\n\r\n          }else {\r\n            this.$toast({\r\n              message: res.data.msg,\r\n              forbidClick: true,\r\n              duration: 3000,\r\n            });\r\n            this.$router.push(\"/login\")\r\n          }\r\n      }).catch((err) => {\r\n        this.$toast.clear();\r\n        console.log(\"err ==> \", err);\r\n      });\r\n\r\n    }\r\n\r\n  }\r\n}\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SetPword.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SetPword.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SetPword.vue?vue&type=template&id=2bcb0df1&\"\nimport script from \"./SetPword.vue?vue&type=script&lang=js&\"\nexport * from \"./SetPword.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}